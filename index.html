<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="Keywords" content="">
        <meta name="Description" content="">
        <style>
            *{
                margin: 0;
            }
            body{
                overflow: hidden;
            }
        </style>
        <title>Hello World!</title>
    </head>
    <body>
        <canvas id="canv" width="400" height="400" style="background: #000;margin: 20px auto; display: block;"></canvas>
        <button onclick="upclick()" style="width:80px;height:80px; margin: 0px auto; display: block;">↑</button>
        <p align="center">
        <button onclick="leftclick()" style="width:80px;height:80px">←</button>
        <button onclick="downclick()" style="width:80px;height:80px">↓</button>
        <button onclick="rightclick()" style="width:80px;height:80px">→</button>
        </p>
        <script>
            var sn = [42, 41], dz=43, fx = 1, n, ctx = document.getElementById("canv").getContext("2d");
            function draw(t, c){
                ctx.fillStyle = c;
                ctx.fillRect(t % 20 * 20 + 1, ~~(t / 20) * 20 + 1, 18, 18);
            };
            function upclick(){
                fx = sn[1] - sn[0] == (n = [-1, -20, 1, 20][38 - 37] || fx) ? fx : n
            }
            function downclick(){
                fx = sn[1] - sn[0] == (n = [-1, -20, 1, 20][40 - 37] || fx) ? fx : n
            }
            function leftclick(){
                fx = sn[1] - sn[0] == (n = [-1, -20, 1, 20][37 - 37] || fx) ? fx : n
            }
            function rightclick(){
                fx = sn[1] - sn[0] == (n = [-1, -20, 1, 20][39 - 37] || fx) ? fx : n
            }
            document.onkeydown = function(e){
                fx = sn[1] - sn[0] == (n = [-1, -20, 1, 20][(e || event).keyCode - 37] || fx) ? fx : n
            }
            !function(){
                sn.unshift(n = sn[0] + fx);
                if(sn.indexOf(n, 1) > 0 || n < 0 || n > 399 || fx == 1 && n % 20 ==0 || fx == -1 && n % 20 == 19){
                alert("Game over!")
                //return window.location.reload()
                }
                draw(n, "pink")
                if(n == dz){
                    while(sn.indexOf(dz = ~~(Math.random() * 400)) >= 0);
                    draw(dz, "hotpink");
                }else{
                    draw(sn.pop(), "black");
                }
                setTimeout(arguments.callee, 130);
            }();
        </script>
    </body>
</html>
